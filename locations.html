<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Global Locations - PiXELL-River</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,600,700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

  <style>
    /* --- GLOBAL SETTINGS --- */
    html { scroll-behavior: smooth; cursor: none; }

    html, body {
      height: 100%; margin: 0; padding: 0;
      font-family: 'Inter', sans-serif;
      background: #050810; color: #fff;
      overflow: hidden; /* No scroll bars for the map app feel */
    }

    /* SELECTION COLOR */
    ::selection { background: #233D8D; color: #fff; }
    ::-moz-selection { background: #233D8D; color: #fff; }

    /* --- TEXTURES & OVERLAYS --- */
    .noise-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; z-index: 8000;
      opacity: 0.06; 
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='1'/%3E%3C/svg%3E");
    }

    /* --- PRELOADER --- */
    .preloader {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
      background: #0d1620; z-index: 99999;
      display: flex; justify-content: center; align-items: center;
      transition: transform 0.8s cubic-bezier(0.7, 0, 0.3, 1);
    }
    .loader-text {
      font-size: 1.5em; letter-spacing: 0.5em; color: #f8d9bc;
      text-transform: uppercase; animation: pulse 2s infinite;
      font-family: 'Playfair Display', serif;
    }
    .preloader.loaded { transform: translateY(-100%); }
    @keyframes pulse { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }

    /* --- CURSOR --- */
    .cursor-dot, .cursor-outline {
      position: fixed; top: 0; left: 0;
      transform: translate(-50%, -50%);
      border-radius: 50%; 
      z-index: 200000; 
      pointer-events: none;
    }
    .cursor-dot { width: 8px; height: 8px; background-color: #f8d9bc; }
    .cursor-outline {
      width: 40px; height: 40px;
      border: 1px solid rgba(248, 217, 188, 0.5);
      transition: width 0.2s, height 0.2s, background-color 0.2s;
    }
    body.hovering .cursor-outline {
      width: 70px; height: 70px;
      background-color: rgba(248, 217, 188, 0.1);
      border-color: transparent; backdrop-filter: blur(2px);
    }

    /* --- MAP CONTAINER --- */
    #map {
      width: 100vw; height: 100vh;
      z-index: 1;
      background: #050810;
    }

    /* --- UI OVERLAYS (Apple Maps Style) --- */
    .ui-layer {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; z-index: 100;
    }

    /* 1. Floating Sidebar */
    .location-panel {
      position: absolute; top: 40px; left: 40px;
      width: 380px; height: calc(100vh - 80px);
      background: rgba(13, 22, 32, 0.85);
      backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(158, 127, 99, 0.2);
      border-radius: 16px;
      pointer-events: auto;
      display: flex; flex-direction: column;
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
      transition: transform 0.4s cubic-bezier(0.2, 1, 0.3, 1);
      opacity: 0; animation: slideIn 0.8s ease forwards 0.5s;
    }
    @keyframes slideIn { from { opacity: 0; transform: translateX(-50px); } to { opacity: 1; transform: translateX(0); } }

    /* Panel Header */
    .panel-header {
      padding: 30px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .brand-label {
      font-size: 0.75em; letter-spacing: 0.2em; text-transform: uppercase; color: #9E7F63; margin-bottom: 5px; display: block;
    }
    .panel-title {
      font-family: 'Playfair Display', serif; font-size: 2em; margin: 0; color: #fff;
    }

    /* Location List */
    .location-list {
      flex: 1; overflow-y: auto; padding: 20px;
    }
    /* Custom scrollbar for list */
    .location-list::-webkit-scrollbar { width: 4px; }
    .location-list::-webkit-scrollbar-thumb { background: #9E7F63; border-radius: 4px; }

    /* Location Card Item */
    .loc-card {
      background: rgba(255,255,255,0.03);
      border-radius: 12px; padding: 20px;
      margin-bottom: 15px; cursor: none; /* Custom Cursor */
      border: 1px solid transparent;
      transition: all 0.3s ease;
    }
    .loc-card:hover, .loc-card.active {
      background: rgba(35, 61, 141, 0.2); /* Sapphire Tint */
      border-color: #233D8D;
      transform: scale(1.02);
    }
    
    .city-name { font-size: 1.1em; font-weight: 600; color: #fff; margin-bottom: 5px; }
    .address-line { font-size: 0.85em; color: rgba(255,255,255,0.6); line-height: 1.4; }
    .status-badge {
      display: inline-block; font-size: 0.7em; margin-top: 10px;
      padding: 4px 8px; border-radius: 4px;
      background: rgba(76, 209, 55, 0.2); color: #4cd137;
    }

    /* 2. Navigation Controls */
    .nav-controls {
      position: absolute; top: 40px; right: 40px;
      pointer-events: auto; display: flex; gap: 15px;
    }
    .circle-btn {
      width: 50px; height: 50px; border-radius: 50%;
      background: rgba(13, 22, 32, 0.9);
      border: 1px solid rgba(158, 127, 99, 0.3);
      color: #9E7F63; display: flex; justify-content: center; align-items: center;
      cursor: none; transition: all 0.3s; text-decoration: none;
    }
    .circle-btn:hover { background: #233D8D; color: #fff; border-color: #233D8D; }

    /* --- CUSTOM MAP MARKERS --- */
    .custom-pin {
      background: #233D8D;
      border: 2px solid #fff;
      border-radius: 50%;
      box-shadow: 0 0 20px rgba(35, 61, 141, 0.8);
    }
    .pin-pulse {
      position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 100%; height: 100%;
      border-radius: 50%;
      border: 1px solid #233D8D;
      animation: pulseRing 2s infinite;
    }
    @keyframes pulseRing {
      0% { width: 100%; height: 100%; opacity: 1; }
      100% { width: 300%; height: 300%; opacity: 0; }
    }

    /* Mobile Adaptation */
    @media (max-width: 768px) {
      .location-panel {
        top: auto; bottom: 20px; left: 20px; right: 20px;
        width: auto; height: 40vh;
      }
      .nav-controls { top: 20px; right: 20px; }
      html { cursor: auto; }
      .cursor-dot, .cursor-outline { display: none; }
    }
  </style>
</head>
<body>

  <div class="noise-overlay"></div>
  <div class="preloader" id="preloader">
    <div class="loader-text">Locating Offices...</div>
  </div>

  <div class="cursor-dot" data-cursor-dot></div>
  <div class="cursor-outline" data-cursor-outline></div>

  <div id="map"></div>

  <div class="ui-layer">
    
    <div class="nav-controls">
      <a href="index.html" class="circle-btn hover-trigger" title="Home"><i class="fa-solid fa-xmark"></i></a>
    </div>

    <div class="location-panel">
      <div class="panel-header">
        <span class="brand-label">Global Presence</span>
        <h1 class="panel-title">Our Offices</h1>
      </div>
      
      <div class="location-list">
        
        <div class="loc-card hover-trigger" onclick="flyToLocation(47.3769, 8.5417, 'Zurich')">
          <div class="city-name">Zürich, CH</div>
          <div class="address-line">Bahnhofstrasse 42<br>8001 Zürich, Switzerland</div>
          <span class="status-badge">● Global HQ</span>
        </div>

        <div class="loc-card hover-trigger" onclick="flyToLocation(46.2044, 6.1432, 'Geneva')">
          <div class="city-name">Geneva, CH</div>
          <div class="address-line">Rue du Rhône 50<br>1204 Geneva, Switzerland</div>
          <span class="status-badge">● Private Wealth</span>
        </div>

        <div class="loc-card hover-trigger" onclick="flyToLocation(51.5074, -0.1278, 'London')">
          <div class="city-name">London, UK</div>
          <div class="address-line">One Canada Square<br>Canary Wharf, London E14 5AB</div>
          <span class="status-badge">● EMEA Hub</span>
        </div>

        <div class="loc-card hover-trigger" onclick="flyToLocation(35.6804, 139.7690, 'Tokyo')">
          <div class="city-name">Tokyo, JP</div>
          <div class="address-line">Marunouchi Building<br>2-4-1 Marunouchi, Chiyoda</div>
          <span class="status-badge">● Asia North</span>
        </div>

        <div class="loc-card hover-trigger" onclick="flyToLocation(40.7128, -74.0060, 'New York')">
          <div class="city-name">New York, USA</div>
          <div class="address-line">30 Hudson Yards<br>New York, NY 10001</div>
          <span class="status-badge">● Americas</span>
        </div>

        <div class="loc-card hover-trigger" onclick="flyToLocation(1.2834, 103.8607, 'Singapore')">
          <div class="city-name">Singapore, SG</div>
          <div class="address-line">Marina Bay Financial Centre<br>10 Marina Blvd, Singapore</div>
          <span class="status-badge">● APAC</span>
        </div>

      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  
  <script>
    // 1. PRELOADER & CURSOR
    window.addEventListener("load", () => {
      document.getElementById("preloader").classList.add("loaded");
    });

    const cursorDot = document.querySelector('[data-cursor-dot]');
    const cursorOutline = document.querySelector('[data-cursor-outline]');

    window.addEventListener('mousemove', function(e) {
      const posX = e.clientX; const posY = e.clientY;
      cursorDot.style.left = `${posX}px`; cursorDot.style.top = `${posY}px`;
      cursorOutline.animate({ left: `${posX}px`, top: `${posY}px` }, { duration: 500, fill: "forwards" });
    });

    document.querySelectorAll('.hover-trigger').forEach(el => {
      el.addEventListener('mouseenter', () => document.body.classList.add('hovering'));
      el.addEventListener('mouseleave', () => document.body.classList.remove('hovering'));
    });

    // 2. INITIALIZE MAP
    // Center on Zurich (HQ) initially, dark styling
    const map = L.map('map', {
      zoomControl: false, // We hide default zoom for cleaner look
      attributionControl: false
    }).setView([47.3769, 8.5417], 13);

    // 3. ADD "DARK MATTER" TILES (The High-End Look)
    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      subdomains: 'abcd',
      maxZoom: 20
    }).addTo(map);

    // 4. DEFINE CUSTOM MARKER ICON (The Glowing Dot)
    const customIcon = L.divIcon({
      className: 'custom-marker-container',
      html: '<div class="custom-pin"><div class="pin-pulse"></div></div>',
      iconSize: [20, 20],
      iconAnchor: [10, 10]
    });

    // 5. ADD LOCATIONS
    const locations = [
      { lat: 47.3769, lng: 8.5417, title: "Zürich HQ" },
      { lat: 46.2044, lng: 6.1432, title: "Geneva" },
      { lat: 51.5074, lng: -0.1278, title: "London" },
      { lat: 35.6804, lng: 139.7690, title: "Tokyo" },
      { lat: 40.7128, lng: -74.0060, title: "New York" },
      { lat: 1.2834, lng: 103.8607, title: "Singapore" }
    ];

    locations.forEach(loc => {
      L.marker([loc.lat, loc.lng], { icon: customIcon }).addTo(map)
        .bindPopup(`<b style="color:#233D8D; font-family:sans-serif;">${loc.title}</b><br>PiXELL-River Financial`);
    });

    // 6. FLY FUNCTION (Apple Maps Animation)
    function flyToLocation(lat, lng, city) {
      map.flyTo([lat, lng], 14, {
        animate: true,
        duration: 2.5 // Slow, cinematic flight
      });

      // Highlight the card visually
      document.querySelectorAll('.loc-card').forEach(c => c.classList.remove('active'));
      event.currentTarget.classList.add('active');
    }

    // 7. CHECK URL PARAMS (If clicking from footer)
    window.onload = function() {
      const urlParams = new URLSearchParams(window.location.search);
      const city = urlParams.get('city');
      if(city === 'london') flyToLocation(51.5074, -0.1278, 'London');
      if(city === 'ny') flyToLocation(40.7128, -74.0060, 'New York');
      if(city === 'sg') flyToLocation(1.2834, 103.8607, 'Singapore');
      if(city === 'tokyo') flyToLocation(35.6804, 139.7690, 'Tokyo');
      if(city === 'zurich') flyToLocation(47.3769, 8.5417, 'Zurich');
    }
  </script>
</body>
</html>